    Для итоговой модели я выбрал CatBoost потому что  датасет состоит в основном из категориальных признаков, а эта библиотека как раза предназначена для работы с ними. Из изучаемых в курсе алгоритмов лучший результат показал Случайный лес, но он не смог сделать предикт на коротком несбалансированном датасете. А так как CatBoost тоже основан на деревьях решений, то выбор пал на него.
    К тому же я не смог применить OneHot кодирование, матрица получалась настолько большой что кодировать приходилось частями, иначе ядро ноутбука падало,  но даже создав закодированную матрицу я не смог её сохранить в pickle, опять же падало ядро. А кодирование в CatBoost происходит автоматически. В принципе можно было применить  BinaryEncoder для кодирования, как я и сделал, но результаты у CatBoost по  roc_auc_score на разных данных оказались лучше. Минусоми CatBoost оказалось большое время обучения и большой вес моделей(итоговая 2.49 GB), зато во время обучения можно было включить "сохранялку" чтобы не потерять результаты в случае падения ядра. 
    Я использовал  
  MacBook Pro 
  Processor Name:	Quad-Core Intel Core i7 
  Processor Speed:	2,2 GHz 
  Number of Processors:	1 
  Total Number of Cores:	4 
  L2 Cache (per Core):	256 KB 
  L3 Cache:	6 MB 
  Memory:	16 GB 
  и обучал модель на CPU, и ядро ноутбука периодически падало. По этой причине я не смог провести поиск лучших гиперпараметров по сетке и кроссвалидацию, но и с дефолтными настройками модель показывает отличные результаты, а для предотвращения переобучения я включал early stopping. На всём датасете предикт делается довольно долго (49.7 s), но предикт для одной строки укладывается в нормативное время.
  Ниже приведены данные некоторых моделей которые я пробовал обучать.
  Итоговая модель обучалась на всем длинном сбалансированном датасете Long_prepared_balanced.
 

    MLPClassifier max_iter  
Обучение на длинном сблансированном датасете  
Размер модели 231 Kb  
Проверка на длинном несбалансированном датасете  
BinaryEncoder()   Wall time: 24.3 s  
predict Wall time: 6.05 s  
roc_auc_score 0.5453570190706214

Проверка на длинном сбалансированном датасете  
predict Wall time: 14.8 s  
roc_auc_score 0.6740966901781562

Проверка на коротком несбалансированном датасете  
ValueError: The feature names should match those that were passed during fit. Feature names seen at fit time, yet now missing:


    DecisionTreeClassifier defolt  
Обучение на длинном сблансированном датасете  
Размер модели 20 Mb  
Проверка на длинном несбалансированном датасете   
BinaryEncoder() Wall time: 26.4 s  
predict Wall time: 1.74 s  
roc_auc_score 0.5033512366303678

Проверка на длинном сбалансированном датасете  
predict Wall time: 5.82 s  
roc_auc_score 0.9701643197348333

Проверка на коротком несбалансированном датасете  
ValueError: The feature names should match those that were passed during fit. Feature names seen at fit time, yet now missing:


    Catboost_model_short_balanced_1   
Обучение на коротком сбалансированном датасете  
'iterations': 125003  
Размер модели 2.16 GB  
Проверка на длинном несбалансированном датасете  
predict Wall time: 2min 3s  
roc_auc_score 0.7997307145953586

Проверка на коротком несбалансированном датасете  
predict Wall time: 1min 23s  
roc_auc_score 0.9676126067142575

catboost_model_long_balanced_1
Обучение на коротком сбалансированном датасете  
'iterations': 15000   
Размер модели 1.41 GB  

Проверка на длинном несбалансированном датасете   
predict Wall time: 32.9 s  
roc_auc_score 0.9710325900106868

Проверка на длинном сбалансированном датасете  
predict Wall time: 1min 12s  
roc_auc_score 0.9710325900106868

Проверка на коротком несбалансированном датасете  
predict Wall time: 23.8 s  
roc_auc_score 0.968074726666546



    catboost_model_long_balanced_all_dataset
Обучение на всём длинном сбалансированном датасете  
'iterations': 17000  
Размер модели 1.88 GB  

Проверка на длинном несбалансированном датасете  
predict Wall time: 45.2 s  
roc_auc_score 0.9739590064186598 

Проверка на длинном сбалансированном датасете  
predict Wall time: 1min 45s  
roc_auc_score 0.9739590064186598

Проверка на коротком несбалансированном датасете  
predict Wall time: 22.4 s  
roc_auc_score 0.9709520155864766  

iterations': 25000   
Размер модели 2.22 GB   

Проверка на длинном несбалансированном датасете  
predict Wall time: 57.6 s  
roc_auc_score 0.9753260259297878

Проверка на длинном сбалансированном датасете  
predict Wall time: 1min 18s  
roc_auc_score 0.9753260259297878

Проверка на коротком несбалансированном датасете
predict Wall time: 39.6 s  
roc_auc_score 0.9722746020959707

'iterations': 35000  
Размер модели 2.49 GB  
Проверка на длинном несбалансированном датасете  
predict Wall time: 1min 8s  
roc_auc_score 0.9762900617470647

Проверка на длинном сбалансированном датасете  
predict Wall time: 2min 17s  
roc_auc_score 0.9762900617470647

Проверка на коротком несбалансированном датасете
predict Wall time: 49.7 s  
roc_auc_score 0.9732255411190504
